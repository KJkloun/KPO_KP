# Отчёт по проекту «Учет финансов»

## Оглавление
1. [Введение](#введение)  
2. [Краткое описание](#краткое-описание)  
3. [Как работает программа (меню)](#как-работает-программа-меню)  
4. [Применённые паттерны](#применённые-паттерны)  
5. [Структура проекта](#структура-проекта)  
6. [Запуск и использование](#запуск-и-использование)  

---

## Введение
«Учет финансов» — это консольное приложение на C#, предназначенное для управления **личными финансами**. С его помощью можно:
- Создавать **банковские счета** с неотрицательным балансом,
- Создавать **категории** (доходные и расходные),
- Регистрировать **операции** (доход/расход) с проверкой баланса,
- Анализировать финансовые данные (суммарный доход и расход за период),
- **Импортировать** и **экспортировать** данные в форматах **JSON**, **CSV** и **YAML**.

В проекте реализованы принципы **SOLID**, **GRASP** и паттерны **GoF** (Factory, Facade, Proxy, Command+Decorator, Template Method, Visitor).

---

## Краткое описание
Основные возможности приложения:
1. **Счета (BankAccount)**  
   - Неотрицательный баланс (запрет на отрицательные суммы).  
   - При создании указываются ID, название и начальный баланс.

2. **Категории (Category)**  
   - Двух типов: «доход» (Income) и «расход» (Expense).  
   - Каждая категория имеет уникальный ID и название.

3. **Операции (Operation)**  
   - Выбираются счёт и категория.  
   - Если операция — «расход», проверяется, чтобы баланс счёта не ушёл в минус.  
   - Каждой операции автоматически присваивается уникальный ID (максимальный существующий + 1).

4. **Импорт/Экспорт данных**  
   - Поддерживаются **JSON**, **CSV**, **YAML**.  
   - **Экспорт** идёт в папку `output` (создаётся автоматически).  
   - **Импорт** ищет файлы в рабочей директории (или по указанному пути).

5. **Простая аналитика**  
   - Подсчёт дохода и расхода за выбранный период (даты начала и конца).  
   - Вывод общей суммы доходов, расходов и разницы.

Хранение данных организовано в памяти через `InMemoryDataStore`. При желании можно заменить его на БД или удалённый сервис (показано на примере прокси).

---

## Как работает программа (меню)

После запуска приложения в консоли отображается меню:
```
— Главное меню —
	1.	Создать счёт
	2.	Создать категорию
	3.	Создать операцию
	4.	Показать все счета
	5.	Показать все категории
	6.	Показать все операции
	7.	Показать аналитику (доход/расход за период)
	8.	Экспорт данных
	9.	Импорт данных
	10.	Выход
```
Выберите пункт:

1. **Создать счёт**  
   - Пользователь вводит ID, название счёта и начальный баланс (≥ 0).  
   - Счёт сохраняется в хранилище (in-memory).

2. **Создать категорию**  
   - Выбирается тип (доход или расход).  
   - Вводятся ID и название категории.  

3. **Создать операцию**  
   - Отображаются доступные счета и категории.  
   - Пользователь выбирает счёт, категорию, сумму.  
   - Проверяется, чтобы при расходе баланс не стал отрицательным.  
   - Операции присваивается новый ID (автоматически).

4. **Показать все счета/категории/операции**  
   - Выводит соответствующие данные, их ID и основные свойства.

5. **Показать аналитику**  
   - Пользователь вводит период (дата начала, дата конца).  
   - Программа считает суммарные доходы и расходы за этот период и выводит итоговую разницу.

6. **Экспорт данных**  
   - Пользователь выбирает формат (JSON, CSV, YAML).  
   - Можно ввести имя файла или использовать дефолтное (`default_export.*`).  
   - Все данные (счета, категории, операции) сохраняются в папку `output`.

7. **Импорт данных**  
   - Аналогично выбирается формат.  
   - Указывается файл (или дефолтный `testdata.*`).  
   - Текущие данные очищаются и загружаются из указанного файла.

8. **Выход**  
   - Завершение работы приложения.

---

## Применённые паттерны

1. **Factory (Фабрика)**  
   - Класс `FinancialEntityFactory` отвечает за создание сущностей (счета, категории, операции) с проверкой корректности (запрет на отрицательные суммы, и т.д.).

2. **Facade (Фасад)**  
   - `BankAccountFacade`, `CategoryFacade`, `OperationFacade`, `AnalyticsFacade` упрощают взаимодействие с `InMemoryDataStore`.  
   - Вместо прямой работы с хранилищем везде используется фасад.

3. **Proxy (Прокси)**  
   - `BankAccountFacadeProxy` (пример): кэширует данные или проверяет права доступа, прежде чем делегировать вызовы реальному фасаду.  
   - Можно легко расширить под сетевое/базовое хранилище.

4. **Command + Decorator**  
   - Каждое действие в меню (например, «Создать счёт») — отдельная команда (Command).  
   - «Декоратор» (`CommandTimerDecorator`) оборачивает команду, замеряя время выполнения.

5. **Template Method (Шаблонный метод)**  
   - Импорт данных реализован через базовый класс `DataImporter` (общий алгоритм чтения файла).  
   - Конкретные реализации (`JsonDataImporter`, `CsvDataImporter`, `YamlDataImporter`) переопределяют метод парсинга.

6. **Visitor (Посетитель)**  
   - Экспорт данных: `IExportVisitor` (например, `JsonExportVisitor`, `CsvExportVisitor`, `YamlExportVisitor`) обходит сущности (счета, категории, операции), формируя файлы в нужном формате.  
   - `ExportManager` вызывает методы посетителя для каждой сущности.

---

## Структура проекта

```plaintext
FinancialManager/
├── Models/
│   ├── BankAccount.cs
│   ├── Category.cs
│   ├── Operation.cs
│   └── TransactionType.cs
├── Factories/
│   └── FinancialEntityFactory.cs
├── DataStore/
│   └── InMemoryDataStore.cs
├── Facades/
│   ├── IBankAccountFacade.cs
│   ├── BankAccountFacade.cs
│   ├── BankAccountFacadeProxy.cs
│   ├── CategoryFacade.cs
│   ├── OperationFacade.cs
│   └── AnalyticsFacade.cs
├── Commands/
│   ├── ICommand.cs
│   ├── CreateBankAccountCommand.cs
│   ├── CreateCategoryCommand.cs
│   ├── CreateOperationCommand.cs
│   ├── ShowAnalyticsCommand.cs
│   ├── ExportDataCommand.cs
│   ├── ImportDataCommand.cs
│   └── CommandTimerDecorator.cs
├── ImportExport/
│   ├── DataImporter.cs
│   ├── JsonDataImporter.cs
│   ├── CsvDataImporter.cs
│   ├── YamlDataImporter.cs
│   ├── IExportVisitor.cs
│   ├── JsonExportVisitor.cs
│   ├── CsvExportVisitor.cs
│   ├── YamlExportVisitor.cs
│   ├── ExportManager.cs
│   └── ImportResult.cs
└── ConsoleUI/
    ├── Program.cs
    ├── InputHelper.cs
    └── MainMenu.cs
```

- Models: доменные классы (счёт, категория, операция).
- Factories: фабрика, создающая объекты с проверкой корректности.
- DataStore: класс InMemoryDataStore, хранящий все объекты в списках.
- Facades: фасады для удобного доступа к хранилищу, Proxy для кэширования/проверки.
- Commands: набор команд и декоратор для замера времени.
- ImportExport: импорт (Template Method) и экспорт (Visitor).
- ConsoleUI: точка входа (Program.cs), меню (MainMenu.cs), утилиты (InputHelper.cs).

 ---

## Запуск и использование

1. Убедитесь, что установлен .NET 6 (или выше).
2. Склонируйте репозиторий (или скопируйте файлы) в нужную директорию.
3. Соберите проект: dotnet build
4. Запустите:  dotnet run

или используйте любимую IDE (Visual Studio, Rider, VS Code).

При запуске в консоли появится главное меню. Следуйте инструкциям для создания счетов, категорий, операций, а также для экспорта/импорта данных.

Экспорт данных
1. Выберите пункт «Экспорт».
2. Выберите формат (JSON, CSV, YAML).
3. Укажите имя файла (или нажмите Enter для значения по умолчанию).
4. Файл будет сохранён в папку output в проекта.

Импорт данных
1. Выберите пункт «Импорт».
2. Аналогично выберите формат и имя файла (или Enter для значения по умолчанию).
3. Текущие данные будут очищены и заменены на загруженные из файла.


P.S: тестирование не успевал сделать(

